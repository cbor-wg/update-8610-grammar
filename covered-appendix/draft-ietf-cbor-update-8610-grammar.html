<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Updates to the CDDL grammar of RFC 8610</title>
<meta content="Carsten Bormann" name="author">
<meta content="
       The Concise Data Definition Language (CDDL), as defined in
RFC¬†8610 and RFC¬†9165,
provides an easy and unambiguous way to express structures for
protocol messages and data formats that are represented in CBOR or
JSON. 
       The present document updates RFC 8610 by addressing errata and making
other small fixes for the ABNF grammar defined for CDDL there. 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="Concise Data Definition Language" name="keyword">
<meta content="draft-ietf-cbor-update-8610-grammar-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-cbor-update-8610-grammar.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "‚áí";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CDDL grammar updates</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bormann</td>
<td class="center">Expires 26 December 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CBOR</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-cbor-update-8610-grammar-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8610" class="eref">8610</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-06-24" class="published">24 June 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-12-26">26 December 2024</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Bormann</div>
<div class="org">Universit√§t Bremen TZI</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Updates to the CDDL grammar of RFC 8610</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Concise Data Definition Language (CDDL), as defined in
RFC¬†8610 and RFC¬†9165,
provides an easy and unambiguous way to express structures for
protocol messages and data formats that are represented in CBOR or
JSON.<a href="#section-abstract-1" class="pilcrow">¬∂</a></p>
<p id="section-abstract-2">The present document updates RFC 8610 by addressing errata and making
other small fixes for the ABNF grammar defined for CDDL there.<a href="#section-abstract-2" class="pilcrow">¬∂</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¬∂</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://cbor-wg.github.io/update-8610-grammar/">https://cbor-wg.github.io/update-8610-grammar/</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-cbor-update-8610-grammar/">https://datatracker.ietf.org/doc/draft-ietf-cbor-update-8610-grammar/</a></span>.<a href="#section-note.1-2" class="pilcrow">¬∂</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        CBOR Working Group mailing list (<span><a href="mailto:cbor@ietf.org">mailto:cbor@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/cbor/">https://mailarchive.ietf.org/arch/browse/cbor/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/cbor/">https://www.ietf.org/mailman/listinfo/cbor/</a></span>.<a href="#section-note.1-3" class="pilcrow">¬∂</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/cbor-wg/update-8610-grammar">https://github.com/cbor-wg/update-8610-grammar</a></span>.<a href="#section-note.1-4" class="pilcrow">¬∂</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¬∂</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¬∂</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¬∂</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 December 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¬∂</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">‚ñ≤</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.¬†¬†<a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.¬†¬†<a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.¬†¬†<a href="#name-clarifications-and-changes-" class="internal xref">Clarifications and Changes based on Errata Reports</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.¬†¬†<a href="#name-updates-to-string-literal-g" class="internal xref">Updates to String Literal Grammar</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref"></a><a href="#name-err6527-text-string-literal" class="internal xref">Err6527 (Text String Literals)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref"></a><a href="#name-err6278-consistent-string-l" class="internal xref">Err6278 (Consistent String Literals)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="auto internal xref"></a><a href="#name-addressing-err6526-err6543" class="internal xref">Addressing Err6526, Err6543</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.¬†¬†<a href="#name-examples-demonstrating-the-" class="internal xref">Examples Demonstrating the Updated String Syntaxes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.¬†¬†<a href="#name-small-enabling-grammar-chan" class="internal xref">Small Enabling Grammar Changes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.¬†¬†<a href="#name-empty-data-models" class="internal xref">Empty data models</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.¬†¬†<a href="#name-non-literal-tag-numbers-sim" class="internal xref">Non-literal Tag Numbers, Simple Values</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.¬†¬†<a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.¬†¬†<a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.¬†¬†<a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.¬†¬†<a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.¬†¬†<a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.¬†¬†<a href="#name-updated-collected-abnf-for-" class="internal xref">Updated Collected ABNF for CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.¬†¬†<a href="#name-details-about-covering-erra" class="internal xref">Details about Covering Errata Report 6543</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-B.1" class="auto internal xref"></a><a href="#name-change-proposed-by-errata-r" class="internal xref">Change Proposed By Errata Report 6543</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#appendix-B.2" class="auto internal xref"></a><a href="#name-no-further-change-needed-af" class="internal xref">No Further Change Needed After Updating String Literal Grammar (Section 2.1)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Concise Data Definition Language (CDDL), as defined in
<span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> and <span>[<a href="#RFC9165" class="cite xref">RFC9165</a>]</span>,
provides an easy and unambiguous way to express structures for
protocol messages and data formats that are represented in CBOR or
JSON.<a href="#section-1-1" class="pilcrow">¬∂</a></p>
<p id="section-1-2">The present document updates <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> by addressing errata and making
other small fixes for the ABNF grammar defined for CDDL there.
The body of this document motivates and explains the updates; the
updated collected ABNF syntax in <a href="#collected-abnf" class="auto internal xref">Figure 11</a> in
<a href="#collected-abnf-appendix" class="auto internal xref">Appendix A</a> replaces the collected ABNF syntax in
<span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.<a href="#section-1-2" class="pilcrow">¬∂</a></p>
<div id="conventions-and-definitions">
<section id="section-1.1">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.1-1">The Terminology from <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> applies.
The grammar in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> is based on ABNF, which is defined in <span>[<a href="#STD68" class="cite xref">STD68</a>]</span>
and <span>[<a href="#RFC7405" class="cite xref">RFC7405</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¬∂</a></p>
</section>
</div>
</section>
</div>
<div id="clari">
<section id="section-2">
      <h2 id="name-clarifications-and-changes-">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-clarifications-and-changes-" class="section-name selfRef">Clarifications and Changes based on Errata Reports</a>
      </h2>
<p id="section-2-1">A number of errata reports have been made around some details of text
string and byte string literal syntax: <span>[<a href="#Err6527" class="cite xref">Err6527</a>]</span> and <span>[<a href="#Err6543" class="cite xref">Err6543</a>]</span>.
These are being addressed in this section, updating details of the
ABNF for these literal syntaxes.
Also, <span>[<a href="#Err6526" class="cite xref">Err6526</a>]</span> needs to be applied (backslashes have been lost during
RFC processing in some text explaining backslash escaping).<a href="#section-2-1" class="pilcrow">¬∂</a></p>
<p id="section-2-2">These changes are intended to mirror the way existing implementations
have dealt with the errata.  They also use the opportunity presented
by the necessary cleanup of the grammar of string literals for a
backward compatible addition to the syntax for hexadecimal escapes.
The latter change is not automatically forward compatible (i.e., CDDL
specifications that make use of this syntax do not necessarily work
with existing implementations until these are updated, which this
specification recommends).<a href="#section-2-2" class="pilcrow">¬∂</a></p>
<div id="e6527">
<section id="section-2.1">
        <h3 id="name-updates-to-string-literal-g">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-updates-to-string-literal-g" class="section-name selfRef">Updates to String Literal Grammar</a>
        </h3>
<div id="err6527-text-string-literals">
<section id="section-2.1.1">
          <h4 id="name-err6527-text-string-literal">
<a href="#name-err6527-text-string-literal" class="section-name selfRef">Err6527 (Text String Literals)</a>
          </h4>
<p id="section-2.1.1-1">The ABNF used in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> for the content of text string literals
is rather permissive:<a href="#section-2.1.1-1" class="pilcrow">¬∂</a></p>
<span id="name-original-rfc-8610-abnf-for-"></span><div id="e6527-orig1">
<figure id="figure-1">
            <div class="lang-abnf sourcecode" id="section-2.1.1-2.1">
<pre>
; RFC 8610 ABNF:
text = %x22 *SCHAR %x22
SCHAR = %x20-21 / %x23-5B / %x5D-7E / %x80-10FFFD / SESC
SESC = "\" (%x20-7E / %x80-10FFFD)
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-original-rfc-8610-abnf-for-" class="selfRef">Original RFC 8610 ABNF for strings with permissive ABNF for SESC, but not allowing hex escapes</a>
            </figcaption></figure>
</div>
<p id="section-2.1.1-3">This allows almost any non-C0 character to be escaped by a backslash,
but critically misses out on the <code>\uXXXX</code> and <code>\uHHHH\uLLLL</code> forms
that JSON allows to specify characters in hex (which should be
applying here according to Bullet 6 of <span><a href="https://rfc-editor.org/rfc/rfc8610#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>).
(Note that CDDL imports from JSON the unwieldy <code>\uHHHH\uLLLL</code> syntax,
which represents Unicode code points beyond U+FFFF by making them look
like UTF-16 surrogate pairs; CDDL text strings are not using UTF-16 or
surrogates.)<a href="#section-2.1.1-3" class="pilcrow">¬∂</a></p>
<p id="section-2.1.1-4">Both can be solved by updating the SESC rule.
This document uses the opportunity to add a popular form of directly specifying
characters in strings using hexadecimal escape sequences of the form
<code>\u{hex}</code>, where <code>hex</code> is the hexadecimal representation of the
Unicode scalar value.
The result is the new set of rules defining SESC in <a href="#e6527-new1" class="auto internal xref">Figure 2</a>:<a href="#section-2.1.1-4" class="pilcrow">¬∂</a></p>
<span id="name-update-to-string-abnf-in-ap"></span><div id="e6527-new1">
<figure id="figure-2">
            <div class="lang-abnf sourcecode" id="section-2.1.1-5.1">
<pre>
; new rules collectively defining SESC:
SESC = "\" ( %x22 / "/" / "\" /                 ; \" \/ \\
             %x62 / %x66 / %x6E / %x72 / %x74 / ; \b \f \n \r \t
             (%x75 hexchar) )                   ; \uXXXX
hexchar = "{" (1*"0" [ hexscalar ] / hexscalar) "}" /
          non-surrogate / (high-surrogate "\" %x75 low-surrogate)
non-surrogate = ((DIGIT / "A"/"B"/"C" / "E"/"F") 3HEXDIG) /
                ("D" %x30-37 2HEXDIG )
high-surrogate = "D" ("8"/"9"/"A"/"B") 2HEXDIG
low-surrogate = "D" ("C"/"D"/"E"/"F") 2HEXDIG
hexscalar = "10" 4HEXDIG / HEXDIG1 4HEXDIG
          / non-surrogate / 1*3HEXDIG
HEXDIG1 = DIGIT1 / "A" / "B" / "C" / "D" / "E" / "F"
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-update-to-string-abnf-in-ap" class="selfRef">Update to string ABNF in Appendix B of RFC 8610: allow hex escapes</a>
            </figcaption></figure>
</div>
<p id="section-2.1.1-6">(Notes:
In ABNF, strings such as <code>"A"</code>, <code>"B"</code> etc. are case-insensitive, as is
intended here.
The rules above could, instead of <code>%x62</code>, also have used <code>%s"b"</code> etc., but didn't, in order to
maximize ABNF tool compatibility.)<a href="#section-2.1.1-6" class="pilcrow">¬∂</a></p>
<p id="section-2.1.1-7">Now that SESC is more restrictively formulated, this also requires an
update to the BCHAR rule used in the ABNF syntax for byte string
literals:<a href="#section-2.1.1-7" class="pilcrow">¬∂</a></p>
<span id="name-original-rfc-8610-abnf-for-b"></span><div id="e6527-orig2">
<figure id="figure-3">
            <div class="lang-abnf sourcecode" id="section-2.1.1-8.1">
<pre>
; RFC 8610 ABNF:
bytes = [bsqual] %x27 *BCHAR %x27
BCHAR = %x20-26 / %x28-5B / %x5D-10FFFD / SESC / CRLF
bsqual = "h" / "b64"
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-original-rfc-8610-abnf-for-b" class="selfRef">Original RFC 8610 ABNF for BCHAR</a>
            </figcaption></figure>
</div>
<p id="section-2.1.1-9">With the SESC updated as above, <code>\'</code> is no longer allowed in BCHAR;
this now needs to be explicitly included; see below.<a href="#section-2.1.1-9" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="e6278">
<section id="section-2.1.2">
          <h4 id="name-err6278-consistent-string-l">
<a href="#name-err6278-consistent-string-l" class="section-name selfRef">Err6278 (Consistent String Literals)</a>
          </h4>
<p id="section-2.1.2-1">Updating BCHAR also provides an opportunity to address <span>[<a href="#Err6278" class="cite xref">Err6278</a>]</span>,
which points to an inconsistency in treating U+007F (DEL) between SCHAR and
BCHAR.
As U+007F is not printable, including it in a byte string literal is
as confusing as for a text string literal, and it should therefore be
excluded from BCHAR as it is from SCHAR.
The same reasoning also applies to the C1 control characters,
so the updated ABNF actually excludes the entire range from U+007F to U+009F.
The same reasoning then also applies to text in comments (PCHAR).
For completeness, all these should also explicitly exclude the code
points that have been set aside for UTF-16's surrogates.<a href="#section-2.1.2-1" class="pilcrow">¬∂</a></p>
<span id="name-update-to-abnf-in-appendix-"></span><div id="e6527-new2">
<figure id="figure-4">
            <div class="lang-abnf sourcecode" id="section-2.1.2-2.1">
<pre>
; new rules for SCHAR, BCHAR, and PCHAR:
SCHAR = %x20-21 / %x23-5B / %x5D-7E / NONASCII / SESC
BCHAR = %x20-26 / %x28-5B / %x5D-7E / NONASCII / SESC / "\'" / CRLF
PCHAR = %x20-7E / NONASCII
NONASCII = %xA0-D7FF / %xE000-10FFFD
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-update-to-abnf-in-appendix-" class="selfRef">Update to ABNF in Appendix B of RFC 8610: BCHAR, SCHAR, and PCHAR</a>
            </figcaption></figure>
</div>
<p id="section-2.1.2-3">(Note that, apart from addressing the inconsistencies, there is no
attempt to further exclude non-printable characters from the ABNF;
doing this properly would draw in complexity from the ongoing
evolution of the Unicode standard that is not needed here.)<a href="#section-2.1.2-3" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="addressing-err6526-err6543">
<section id="section-2.1.3">
          <h4 id="name-addressing-err6526-err6543">
<a href="#name-addressing-err6526-err6543" class="section-name selfRef">Addressing Err6526, Err6543</a>
          </h4>
<p id="section-2.1.3-1">The above changes also cover <span>[<a href="#Err6543" class="cite xref">Err6543</a>]</span> (a proposal to split off
qualified byte string literals from UTF-8 byte string literals) and
<span>[<a href="#Err6526" class="cite xref">Err6526</a>]</span> (lost backslashes); see <a href="#Err6543-covered" class="auto internal xref">Appendix B</a> for details.<a href="#section-2.1.3-1" class="pilcrow">¬∂</a></p>
</section>
</div>
</section>
</div>
<div id="examples-demonstrating-the-updated-string-syntaxes">
<section id="section-2.2">
        <h3 id="name-examples-demonstrating-the-">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-examples-demonstrating-the-" class="section-name selfRef">Examples Demonstrating the Updated String Syntaxes</a>
        </h3>
<p id="section-2.2-1">The CDDL example in <a href="#string-examples" class="auto internal xref">Figure 5</a> demonstrates various escaping
techniques now available for (byte and text) strings in CDDL.
Obviously in the literals for <code>a</code> and <code>x</code>, there is no need to escape
the second character, an <code>o</code>, as <code>\u{6f}</code>; this is just for demonstration.
Similarly, as shown in <code>c</code> and <code>z</code> there also is no need to escape the
<code>üÅ≥</code> or <code>‚åò</code>, but escaping them may be convenient in order to limit the character
repertoire of a CDDL file itself to ASCII <span>[<a href="#STD80" class="cite xref">STD80</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¬∂</a></p>
<span id="name-example-text-and-byte-strin"></span><div id="string-examples">
<figure id="figure-5">
          <div class="lang-cddl sourcecode" id="section-2.2-2.1">
<pre>
start = [a, b, c, x, y, z]

; "üÅ≥", DOMINO TILE VERTICAL-02-02, and
; "‚åò", PLACE OF INTEREST SIGN, in a text string:
a = "D\u{6f}mino's \u{1F073} + \u{2318}"      ; \u{}-escape 3 chars
b = "Domino's \uD83C\uDC73 + \u2318"          ; escape JSON-like
c = "Domino's üÅ≥ + ‚åò"                          ; unescaped

; in a byte string given as text, the ' needs to be escaped:
x = 'D\u{6f}mino\u{27}s \u{1F073} + \u{2318}' ; \u{}-escape 4 chars
y = 'Domino\'s \uD83C\uDC73 + \u2318'         ; escape JSON-like
z = 'Domino\'s üÅ≥ + ‚åò'                         ; escape ' only
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-text-and-byte-strin" class="selfRef">Example text and byte string literals with various escaping techniques</a>
          </figcaption></figure>
</div>
<p id="section-2.2-3">In this example, the rules a to c and x to z all produce strings with
byte-wise identical content, where a to c are text strings, and x to z
are byte strings.
<a href="#string-examples-pretty" class="auto internal xref">Figure 6</a> illustrates this by showing the output generated from
the <code>start</code> rule in <a href="#string-examples" class="auto internal xref">Figure 5</a>, using pretty-printed hexadecimal.<a href="#section-2.2-3" class="pilcrow">¬∂</a></p>
<span id="name-generated-cbor-from-cddl-ex"></span><div id="string-examples-pretty">
<figure id="figure-6">
          <div class="lang-cbor-pretty sourcecode" id="section-2.2-4.1">
<pre>
86                                      # array(6)
   73                                   # text(19)
      446f6d696e6f277320f09f81b3202b20e28c98 # "Domino's üÅ≥ + ‚åò"
   73                                   # text(19)
      446f6d696e6f277320f09f81b3202b20e28c98 # "Domino's üÅ≥ + ‚åò"
   73                                   # text(19)
      446f6d696e6f277320f09f81b3202b20e28c98 # "Domino's üÅ≥ + ‚åò"
   53                                   # bytes(19)
      446f6d696e6f277320f09f81b3202b20e28c98 # "Domino's üÅ≥ + ‚åò"
   53                                   # bytes(19)
      446f6d696e6f277320f09f81b3202b20e28c98 # "Domino's üÅ≥ + ‚åò"
   53                                   # bytes(19)
      446f6d696e6f277320f09f81b3202b20e28c98 # "Domino's üÅ≥ + ‚åò"
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-generated-cbor-from-cddl-ex" class="selfRef">Generated CBOR from CDDL example (Pretty-Printed Hexadecimal)</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="small-enabling-grammar-changes">
<section id="section-3">
      <h2 id="name-small-enabling-grammar-chan">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-small-enabling-grammar-chan" class="section-name selfRef">Small Enabling Grammar Changes</a>
      </h2>
<p id="section-3-1">The two subsections in this section specify two small changes to the
grammar that are intended to enable certain kinds of specifications.
These changes are backward compatible, i.e., CDDL files that
comply to <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> continue to match the updated grammar, but not
necessarily forward compatible, i.e., CDDL specifications that make
use of these changes cannot necessarily be processed by existing <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>
implementations.<a href="#section-3-1" class="pilcrow">¬∂</a></p>
<div id="empty">
<section id="section-3.1">
        <h3 id="name-empty-data-models">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-empty-data-models" class="section-name selfRef">Empty data models</a>
        </h3>
<p id="section-3.1-1"><span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> requires a CDDL file to have at least one rule.<a href="#section-3.1-1" class="pilcrow">¬∂</a></p>
<span id="name-original-rfc-8610-abnf-for-t"></span><div id="empty-orig">
<figure id="figure-7">
          <div class="lang-abnf sourcecode" id="section-3.1-2.1">
<pre>
; RFC 8610 ABNF:
cddl = S 1*(rule S)
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-original-rfc-8610-abnf-for-t" class="selfRef">Original RFC 8610 ABNF for top-level rule cddl</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">This makes sense when the file has to stand alone, as a CDDL data
model needs to have at least one rule to provide an entry point (start
rule).<a href="#section-3.1-3" class="pilcrow">¬∂</a></p>
<p id="section-3.1-4">With CDDL modules <span>[<a href="#I-D.ietf-cbor-cddl-modules" class="cite xref">I-D.ietf-cbor-cddl-modules</a>]</span>, CDDL files can also include directives,
and these might be the source of all the rules that
ultimately make up the module created by the file.
Any other rule content in the file has to be available for directive
processing, making the requirement for at least one rule cumbersome.<a href="#section-3.1-4" class="pilcrow">¬∂</a></p>
<p id="section-3.1-5">Therefore, the present update extends the grammar as in <a href="#empty-new" class="auto internal xref">Figure 8</a>
and turns the existence of at least one rule into a semantic constraint, to
be fulfilled after processing of all directives.<a href="#section-3.1-5" class="pilcrow">¬∂</a></p>
<span id="name-update-to-top-level-abnf-in"></span><div id="empty-new">
<figure id="figure-8">
          <div class="lang-abnf sourcecode" id="section-3.1-6.1">
<pre>
; new top-level rule:
cddl = S *(rule S)
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-update-to-top-level-abnf-in" class="selfRef">Update to top-level ABNF in Appendices B and C of RFC 8610</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="tagnum">
<section id="section-3.2">
        <h3 id="name-non-literal-tag-numbers-sim">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-non-literal-tag-numbers-sim" class="section-name selfRef">Non-literal Tag Numbers, Simple Values</a>
        </h3>
<p id="section-3.2-1">The existing ABNF syntax for expressing tags in CDDL is:<a href="#section-3.2-1" class="pilcrow">¬∂</a></p>
<span id="name-original-rfc-8610-abnf-for-ta"></span><div id="tag-orig">
<figure id="figure-9">
          <div class="lang-abnf sourcecode" id="section-3.2-2.1">
<pre>
; extracted from RFC 8610 ABNF:
type2 =/ "#" "6" ["." uint] "(" S type S ")"
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-original-rfc-8610-abnf-for-ta" class="selfRef">Original RFC 8610 ABNF for tag syntax</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">This means tag numbers can only be given as literal numbers (uints).
Some specifications operate on ranges of tag numbers, e.g., <span>[<a href="#RFC9277" class="cite xref">RFC9277</a>]</span>
has a range of tag numbers 1668546817 (0x63740101) to 1668612095
(0x6374FFFF) to tag specific content formats.
This can currently not be expressed in CDDL.
Similar considerations apply to simple values (<code>#7.</code>xx).<a href="#section-3.2-3" class="pilcrow">¬∂</a></p>
<p id="section-3.2-4">This update extends the syntax to:<a href="#section-3.2-4" class="pilcrow">¬∂</a></p>
<span id="name-update-to-tag-and-simple-va"></span><div id="tag-new">
<figure id="figure-10">
          <div class="lang-abnf sourcecode" id="section-3.2-5.1">
<pre>
; new rules collectively defining the tagged case:
type2 =/ "#" "6" ["." head-number] "(" S type S ")"
       / "#" "7" ["." head-number]
head-number = uint / ("&lt;" type "&gt;")
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-update-to-tag-and-simple-va" class="selfRef">Update to tag and simple value ABNF in Appendices B and C of RFC 8610</a>
          </figcaption></figure>
</div>
<p id="section-3.2-6">For <code>#6</code>, the <code>head-number</code> stands for the tag number.
For <code>#7</code>, the <code>head-number</code> stands for the simple value if it is in
the ranges 0..23 or 32..255 (as per Section <a href="https://rfc-editor.org/rfc/rfc8949#section-3.3" class="relref">3.3</a> of RFC 8949 <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>
the simple values 24..31 are not used).
For 24..31, the <code>head-number</code> stands for the "additional
information", e.g., <code>#7.25</code> or <code>#7.&lt;25&gt;</code> is a float16, etc.
(All ranges mentioned here are inclusive.)<a href="#section-3.2-6" class="pilcrow">¬∂</a></p>
<p id="section-3.2-7">So the above range can be expressed in a CDDL fragment such as:<a href="#section-3.2-7" class="pilcrow">¬∂</a></p>
<div class="lang-cddl sourcecode" id="section-3.2-8">
<pre>
ct-tag&lt;content&gt; = #6.&lt;ct-tag-number&gt;(content)
ct-tag-number = 1668546817..1668612095
; or use 0x63740101..0x6374FFFF
</pre><a href="#section-3.2-8" class="pilcrow">¬∂</a>
</div>
<p id="section-3.2-9">Notes:<a href="#section-3.2-9" class="pilcrow">¬∂</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-10">
<li id="section-3.2-10.1">
            <p id="section-3.2-10.1.1">This syntax reuses the angle bracket syntax for generics;
this reuse is innocuous as a generic parameter/argument only ever
occurs after a rule name (<code>id</code>), while it occurs after <code>.</code> here.
(Whether there is potential for human confusion can be debated; the
above example deliberately uses generics as well.)<a href="#section-3.2-10.1.1" class="pilcrow">¬∂</a></p>
</li>
          <li id="section-3.2-10.2">
            <p id="section-3.2-10.2.1">The updated ABNF grammar makes it a bit more explicit that the
number given after the optional dot is special, not giving the CBOR
"additional information" for tags and simple values as it is with
other uses of <code>#</code> in CDDL.
(Adding this observation to <span><a href="https://rfc-editor.org/rfc/rfc8610#section-2.2.3" class="relref">Section 2.2.3</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> is the subject
of <span>[<a href="#Err6575" class="cite xref">Err6575</a>]</span>; it is correctly noted in <span><a href="https://rfc-editor.org/rfc/rfc8610#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.)
In hindsight, maybe a different character than the dot should have
been chosen for this special case, however changing the grammar
now would have been too disruptive.<a href="#section-3.2-10.2.1" class="pilcrow">¬∂</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">The grammar fixes and updates in this document are not believed to
create additional security considerations.
The security considerations in <span><a href="https://rfc-editor.org/rfc/rfc8610#section-5" class="relref">Section 5</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> do apply, and
specifically the potential for confusion is increased in an
environment that uses a combination of CDDL tools some of which have
been updated and some of which have not been, in particular based on
<a href="#clari" class="auto internal xref">Section 2</a>.<a href="#section-4-1" class="pilcrow">¬∂</a></p>
<p id="section-4-2">Attackers may want to exploit such potential confusion by crafting
CDDL models that are interpreted differently by different parts of a
system.
There will be a period of transition from the details that the
<span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> grammar handled in a less well-defined way, to the updated
grammar defined in the present document.
This transition might offer one, but not the only kind of opportunity
for the kind of attack that relies on differences between
implementations.
Implementations that make use of CDDL models operationally already
need to ascertain the provenance (and thus authenticity and integrity)
and applicability of models they employ.
At the time of writing, it is expected that the models will generally
be processed by a software developer, within a software development
environment.
Developers are therefore advised to treat CDDL models with
the same care as any other source code.<a href="#section-4-2" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no IANA actions.<a href="#section-5-1" class="pilcrow">¬∂</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD68">[STD68]</dt>
        <dd>
<div class="refInstance">Internet Standard 68, <span>&lt;<a href="https://www.rfc-editor.org/info/std68">https://www.rfc-editor.org/info/std68</a>&gt;</span>.<br><span>At the time of writing, this STD comprises the following:</span>
</div>
<div class="refInstance" id="RFC5234">
            <span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
      <dd>
<div class="refInstance">Internet Standard 94, <span>&lt;<a href="https://www.rfc-editor.org/info/std94">https://www.rfc-editor.org/info/std94</a>&gt;</span>.<br><span>At the time of writing, this STD comprises the following:</span>
</div>
<div class="refInstance" id="RFC8949">
            <span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Err6278">[Err6278]</dt>
        <dd>
<span class="refTitle">"Errata Report 6278"</span>, <span class="seriesInfo">RFC 8610</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid6278">https://www.rfc-editor.org/errata/eid6278</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Err6526">[Err6526]</dt>
        <dd>
<span class="refTitle">"Errata Report 6526"</span>, <span class="seriesInfo">RFC 8610</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid6526">https://www.rfc-editor.org/errata/eid6526</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Err6527">[Err6527]</dt>
        <dd>
<span class="refTitle">"Errata Report 6527"</span>, <span class="seriesInfo">RFC 8610</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid6527">https://www.rfc-editor.org/errata/eid6527</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Err6543">[Err6543]</dt>
        <dd>
<span class="refTitle">"Errata Report 6543"</span>, <span class="seriesInfo">RFC 8610</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid6543">https://www.rfc-editor.org/errata/eid6543</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Err6575">[Err6575]</dt>
        <dd>
<span class="refTitle">"Errata Report 6575"</span>, <span class="seriesInfo">RFC 8610</span>, <span>&lt;<a href="https://www.rfc-editor.org/errata/eid6575">https://www.rfc-editor.org/errata/eid6575</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-cddl-modules">[I-D.ietf-cbor-cddl-modules]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">B. Moran</span>, <span class="refTitle">"CDDL Module Structure"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-cddl-modules-02</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-cddl-modules-02">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-cddl-modules-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-edn-literals">[I-D.ietf-cbor-edn-literals]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Extended Diagnostic Notation (EDN): Application-Oriented Literals, ABNF, and Media Type"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-literals-09</span>, <time datetime="2024-05-18" class="refDate">18 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-09">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7405">[RFC7405]</dt>
        <dd>
<span class="refAuthor">Kyzivat, P.</span>, <span class="refTitle">"Case-Sensitive String Support in ABNF"</span>, <span class="seriesInfo">RFC 7405</span>, <span class="seriesInfo">DOI 10.17487/RFC7405</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7405">https://www.rfc-editor.org/rfc/rfc7405</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9165">[RFC9165]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Additional Control Operators for the Concise Data Definition Language (CDDL)"</span>, <span class="seriesInfo">RFC 9165</span>, <span class="seriesInfo">DOI 10.17487/RFC9165</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9165">https://www.rfc-editor.org/rfc/rfc9165</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9277">[RFC9277]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"On Stable Storage for Items in Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9277</span>, <span class="seriesInfo">DOI 10.17487/RFC9277</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9277">https://www.rfc-editor.org/rfc/rfc9277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD80">[STD80]</dt>
      <dd>
<div class="refInstance">Internet Standard 80, <span>&lt;<a href="https://www.rfc-editor.org/info/std80">https://www.rfc-editor.org/info/std80</a>&gt;</span>.<br><span>At the time of writing, this STD comprises the following:</span>
</div>
<div class="refInstance" id="RFC0020">
            <span class="refAuthor">Cerf, V.</span>, <span class="refTitle">"ASCII format for network interchange"</span>, <span class="seriesInfo">STD 80</span>, <span class="seriesInfo">RFC 20</span>, <span class="seriesInfo">DOI 10.17487/RFC0020</span>, <time datetime="1969-10" class="refDate">October 1969</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;</span>. </div>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="collected-abnf-appendix">
<section id="appendix-A">
      <h2 id="name-updated-collected-abnf-for-">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-updated-collected-abnf-for-" class="section-name selfRef">Updated Collected ABNF for CDDL</a>
      </h2>
<p id="appendix-A-1">This appendix is normative.<a href="#appendix-A-1" class="pilcrow">¬∂</a></p>
<p id="appendix-A-2">It provides the full ABNF from <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> with the updates
applied in the present document.<a href="#appendix-A-2" class="pilcrow">¬∂</a></p>
<span id="name-abnf-for-cddl-as-updated"></span><div id="collected-abnf">
<figure id="figure-11">
        <div class="breakable lang-abnf sourcecode" id="appendix-A-3.1">
<pre>
cddl = S *(rule S)
rule = typename [genericparm] S assignt S type
     / groupname [genericparm] S assigng S grpent

typename = id
groupname = id

assignt = "=" / "/="
assigng = "=" / "//="

genericparm = "&lt;" S id S *("," S id S ) "&gt;"
genericarg = "&lt;" S type1 S *("," S type1 S ) "&gt;"

type = type1 *(S "/" S type1)

type1 = type2 [S (rangeop / ctlop) S type2]
; space may be needed before the operator if type2 ends in a name

type2 = value
      / typename [genericarg]
      / "(" S type S ")"
      / "{" S group S "}"
      / "[" S group S "]"
      / "~" S typename [genericarg]
      / "&amp;" S "(" S group S ")"
      / "&amp;" S groupname [genericarg]
      / "#" "6" ["." head-number] "(" S type S ")"
      / "#" "7" ["." head-number]
      / "#" DIGIT ["." uint]                ; major/ai
      / "#"                                 ; any
head-number = uint / ("&lt;" type "&gt;")

rangeop = "..." / ".."

ctlop = "." id

group = grpchoice *(S "//" S grpchoice)

grpchoice = *(grpent optcom)

grpent = [occur S] [memberkey S] type
       / [occur S] groupname [genericarg]  ; preempted by above
       / [occur S] "(" S group S ")"

memberkey = type1 S ["^" S] "=&gt;"
          / bareword S ":"
          / value S ":"

bareword = id

optcom = S ["," S]

occur = [uint] "*" [uint]
      / "+"
      / "?"

uint = DIGIT1 *DIGIT
     / "0x" 1*HEXDIG
     / "0b" 1*BINDIG
     / "0"

value = number
      / text
      / bytes

int = ["-"] uint

; This is a float if it has fraction or exponent; int otherwise
number = hexfloat / (int ["." fraction] ["e" exponent ])
hexfloat = ["-"] "0x" 1*HEXDIG ["." 1*HEXDIG] "p" exponent
fraction = 1*DIGIT
exponent = ["+"/"-"] 1*DIGIT

text = %x22 *SCHAR %x22
SCHAR = %x20-21 / %x23-5B / %x5D-7E / NONASCII / SESC

SESC = "\" ( %x22 / "/" / "\" /                 ; \" \/ \\
             %x62 / %x66 / %x6E / %x72 / %x74 / ; \b \f \n \r \t
             (%x75 hexchar) )                   ; \uXXXX

hexchar = "{" (1*"0" [ hexscalar ] / hexscalar) "}" /
          non-surrogate / (high-surrogate "\" %x75 low-surrogate)
non-surrogate = ((DIGIT / "A"/"B"/"C" / "E"/"F") 3HEXDIG) /
                ("D" %x30-37 2HEXDIG )
high-surrogate = "D" ("8"/"9"/"A"/"B") 2HEXDIG
low-surrogate = "D" ("C"/"D"/"E"/"F") 2HEXDIG
hexscalar = "10" 4HEXDIG / HEXDIG1 4HEXDIG
          / non-surrogate / 1*3HEXDIG

bytes = [bsqual] %x27 *BCHAR %x27
BCHAR = %x20-26 / %x28-5B / %x5D-7E / NONASCII / SESC / "\'" / CRLF
bsqual = "h" / "b64"

id = EALPHA *(*("-" / ".") (EALPHA / DIGIT))
ALPHA = %x41-5A / %x61-7A
EALPHA = ALPHA / "@" / "_" / "$"
DIGIT = %x30-39
DIGIT1 = %x31-39
HEXDIG = DIGIT / "A" / "B" / "C" / "D" / "E" / "F"
HEXDIG1 = DIGIT1 / "A" / "B" / "C" / "D" / "E" / "F"
BINDIG = %x30-31

S = *WS
WS = SP / NL
SP = %x20
NL = COMMENT / CRLF
COMMENT = ";" *PCHAR CRLF
PCHAR = %x20-7E / NONASCII
NONASCII = %xA0-D7FF / %xE000-10FFFD
CRLF = %x0A / %x0D.0A
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-abnf-for-cddl-as-updated" class="selfRef">ABNF for CDDL as updated</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="Err6543-covered">
<section id="appendix-B">
      <h2 id="name-details-about-covering-erra">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-details-about-covering-erra" class="section-name selfRef">Details about Covering Errata Report 6543</a>
      </h2>
<p id="appendix-B-1">This appendix is informative.<a href="#appendix-B-1" class="pilcrow">¬∂</a></p>
<p id="appendix-B-2"><span>[<a href="#Err6543" class="cite xref">Err6543</a>]</span> observes that
the ABNF used in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> for the content of byte string literals
lumps together byte strings notated as text with byte strings notated
in base16 (hex) or base64 (but see also updated BCHAR rule in <a href="#e6527-new2" class="auto internal xref">Figure 4</a>):<a href="#appendix-B-2" class="pilcrow">¬∂</a></p>
<span id="name-original-rfc-8610-abnf-for-bc"></span><div id="e6527-orig2a">
<figure id="figure-12">
        <div class="lang-abnf sourcecode" id="appendix-B-3.1">
<pre>
; RFC 8610 ABNF:
bytes = [bsqual] %x27 *BCHAR %x27
BCHAR = %x20-26 / %x28-5B / %x5D-10FFFD / SESC / CRLF
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-original-rfc-8610-abnf-for-bc" class="selfRef">Original RFC 8610 ABNF for BCHAR</a>
        </figcaption></figure>
</div>
<div id="change-proposed-by-errata-report-6543">
<section id="appendix-B.1">
        <h3 id="name-change-proposed-by-errata-r">
<a href="#name-change-proposed-by-errata-r" class="section-name selfRef">Change Proposed By Errata Report 6543</a>
        </h3>
<p id="appendix-B.1-1">Errata report 6543 proposes to handle the two cases in separate
ABNF rules (where, with an updated SESC, BCHAR obviously needs to be
updated as above):<a href="#appendix-B.1-1" class="pilcrow">¬∂</a></p>
<span id="name-errata-report-8653-proposal"></span><div id="e6543-1">
<figure id="figure-13">
          <div class="lang-abnf sourcecode" id="appendix-B.1-2.1">
<pre>
; Err6543 proposal:
bytes = %x27 *BCHAR %x27
      / bsqual %x27 *QCHAR %x27
BCHAR = %x20-26 / %x28-5B / %x5D-10FFFD / SESC / CRLF
QCHAR = DIGIT / ALPHA / "+" / "/" / "-" / "_" / "=" / WS
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-errata-report-8653-proposal" class="selfRef">Errata Report 8653 Proposal to Split the Byte String Rules</a>
          </figcaption></figure>
</div>
<p id="appendix-B.1-3">This potentially causes a subtle change, which is hidden in the WS rule:<a href="#appendix-B.1-3" class="pilcrow">¬∂</a></p>
<span id="name-abnf-definition-of-ws-from-"></span><div id="e6543-2">
<figure id="figure-14">
          <div class="lang-abnf sourcecode" id="appendix-B.1-4.1">
<pre>
; RFC 8610 ABNF:
WS = SP / NL
SP = %x20
NL = COMMENT / CRLF
COMMENT = ";" *PCHAR CRLF
PCHAR = %x20-7E / %x80-10FFFD
CRLF = %x0A / %x0D.0A
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-abnf-definition-of-ws-from-" class="selfRef">ABNF definition of WS from RFC 8610</a>
          </figcaption></figure>
</div>
<p id="appendix-B.1-5">This allows any non-C0 character in a comment, so this fragment
becomes possible:<a href="#appendix-B.1-5" class="pilcrow">¬∂</a></p>
<div class="lang-cddl sourcecode" id="appendix-B.1-6">
<pre>
foo = h'
   43424F52 ; 'CBOR'
   0A       ; LF, but don't use CR!
'
</pre><a href="#appendix-B.1-6" class="pilcrow">¬∂</a>
</div>
<p id="appendix-B.1-7">The current text is not unambiguously saying whether the three apostrophes
need to be escaped with a <code>\</code> or not, as in:<a href="#appendix-B.1-7" class="pilcrow">¬∂</a></p>
<div class="lang-cddl sourcecode" id="appendix-B.1-8">
<pre>
foo = h'
   43424F52 ; \'CBOR\'
   0A       ; LF, but don\'t use CR!
'
</pre><a href="#appendix-B.1-8" class="pilcrow">¬∂</a>
</div>
<p id="appendix-B.1-9">... which would be supported by the existing ABNF in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.<a href="#appendix-B.1-9" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="no-further-change-needed-after-updating-string-literal-grammar-e6527">
<section id="appendix-B.2">
        <h3 id="name-no-further-change-needed-af">
<a href="#name-no-further-change-needed-af" class="section-name selfRef">No Further Change Needed After Updating String Literal Grammar (<span class="cite xref">Section 2.1</span>)</a>
        </h3>
<p id="appendix-B.2-1">This document takes the simpler approach of leaving the processing of
the content of the byte string literal to a semantic step after
processing the syntax of the <code>bytes</code>/<code>BCHAR</code> rules, as updated by
<a href="#e6527-new1" class="auto internal xref">Figure 2</a> and <a href="#e6527-new2" class="auto internal xref">Figure 4</a> in <a href="#e6527" class="auto internal xref">Section 2.1</a> (updates prompted by the combination
of <span>[<a href="#Err6527" class="cite xref">Err6527</a>]</span> and <span>[<a href="#Err6278" class="cite xref">Err6278</a>]</span>).<a href="#appendix-B.2-1" class="pilcrow">¬∂</a></p>
<p id="appendix-B.2-2">The rules in <a href="#e6543-2" class="auto internal xref">Figure 14</a> (as updated by <a href="#e6527-new2" class="auto internal xref">Figure 4</a>) are therefore
applied to the result of this
processing where <code>bsqual</code> is given as <code>h</code> or <code>b64</code>.<a href="#appendix-B.2-2" class="pilcrow">¬∂</a></p>
<p id="appendix-B.2-3">Note that this approach also works well with the use of byte strings
in <span><a href="https://rfc-editor.org/rfc/rfc9165#section-3" class="relref">Section 3</a> of [<a href="#RFC9165" class="cite xref">RFC9165</a>]</span>.
It does require some care when copy-pasting into CDDL models from ABNF
that contains single quotes (which may also hide as apostrophes
in comments); these need to be escaped or possibly replaced by <code>%x27</code>.<a href="#appendix-B.2-3" class="pilcrow">¬∂</a></p>
<p id="appendix-B.2-4">Finally, the approach taken lends support to extending <code>bsqual</code> in CDDL
similar to the way this is done for CBOR diagnostic notation in <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span>.
(Note that the processing of string literals now is quite similar between
CDDL and EDN, except that CDDL has "<code>;</code>"-based end-of-line comments, while EDN has
two comment syntaxes, in-line "<code>/</code>"-based and end-of-line "<code>#</code>"-based.)<a href="#appendix-B.2-4" class="pilcrow">¬∂</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">Many thanks go to the submitters of the errata reports addressed in
this document.
In one of the ensuing discussions, <span class="contact-name">Doug Ewell</span> proposed to define an
ABNF rule NONASCII, of which we have included the essence.
Special thanks to the reviewers <span class="contact-name">Marco Tiloca</span>, <span class="contact-name">Christian Ams√ºss</span> (shepherd review and further guidance), <span class="contact-name">Orie Steele</span> (AD
review and further guidance), and √âric Vyncke
(detailed IESG review).<a href="#appendix-C-1" class="pilcrow">¬∂</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carsten Bormann</span></div>
<div dir="auto" class="left"><span class="org">Universit√§t Bremen TZI</span></div>
<div dir="auto" class="left"><span class="street-address">Postfach 330440</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49-421-218-63921" class="tel">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cabo@tzi.org" class="email">cabo@tzi.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
